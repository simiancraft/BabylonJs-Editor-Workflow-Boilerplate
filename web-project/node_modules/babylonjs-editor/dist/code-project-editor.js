!function(e){function t(e){Object.defineProperty(this,e,{enumerable:!0,get:function(){return this[v][e]}})}function r(e){if("undefined"!=typeof System&&System.isModule?System.isModule(e):"[object Module]"===Object.prototype.toString.call(e))return e;var t={default:e,__useDefault:e};if(e&&e.__esModule)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return new o(t)}function o(e){Object.defineProperty(this,v,{value:e}),Object.keys(e).forEach(t,this)}function n(e){return"@node/"===e.substr(0,6)?c(e,r(m(e.substr(6))),{}):p[e]}function u(e){var t=n(e);if(!t)throw new Error('Module "'+e+'" expected, but not contained in build.');if(t.module)return t.module;var r=t.linkRecord;return i(t,r),a(t,r,[]),t.module}function i(e,t){if(!t.depLoads){t.declare&&d(e,t),t.depLoads=[];for(var r=0;r<t.deps.length;r++){var o=n(t.deps[r]);t.depLoads.push(o),o.linkRecord&&i(o,o.linkRecord);var u=t.setters&&t.setters[r];u&&(u(o.module||o.linkRecord.moduleObj),o.importerSetters.push(u))}return e}}function d(t,r){var o=r.moduleObj,n=t.importerSetters,u=!1,i=r.declare.call(e,function(e,t){if(!u){if("object"==typeof e)for(var r in e)"__useDefault"!==r&&(o[r]=e[r]);else o[e]=t;u=!0;for(var i=0;i<n.length;i++)n[i](o);return u=!1,t}},{id:t.key});"function"!=typeof i?(r.setters=i.setters,r.execute=i.execute):(r.setters=[],r.execute=i)}function l(e,t,r){return p[e]={key:e,module:void 0,importerSetters:[],linkRecord:{deps:t,depLoads:void 0,declare:r,setters:void 0,execute:void 0,moduleObj:{}}}}function f(e,t,r,o){var n={};return p[e]={key:e,module:void 0,importerSetters:[],linkRecord:{deps:t,depLoads:void 0,declare:void 0,execute:o,executingRequire:r,moduleObj:{default:n,__useDefault:n},setters:void 0}}}function s(e,t,r){return function(o){for(var n=0;n<e.length;n++)if(e[n]===o){var u,i=t[n],d=i.linkRecord;return u=d?-1===r.indexOf(i)?a(i,d,r):d.moduleObj:i.module,"__useDefault"in u?u.__useDefault:u}}}function a(t,r,n){if(n.push(t),t.module)return t.module;if(r.setters){for(var i=0;i<r.deps.length;i++){var d=r.depLoads[i],l=d.linkRecord;l&&-1===n.indexOf(d)&&a(d,l,l.setters?n:[])}r.execute.call(y)}else{var f={id:t.key},c=r.moduleObj;Object.defineProperty(f,"exports",{configurable:!0,set:function(e){c.default=c.__useDefault=e},get:function(){return c.__useDefault}});var p=s(r.deps,r.depLoads,n);if(!r.executingRequire)for(var i=0;i<r.deps.length;i++)p(r.deps[i]);var v=r.execute.call(e,p,c.__useDefault,f);void 0!==v?c.default=c.__useDefault=v:f.exports!==c.__useDefault&&(c.default=c.__useDefault=f.exports);var m=c.__useDefault;if(m&&m.__esModule)for(var b in m)Object.hasOwnProperty.call(m,b)&&(c[b]=m[b])}var f=t.module=new o(r.moduleObj);if(!r.setters)for(var i=0;i<t.importerSetters.length;i++)t.importerSetters[i](f);return f}function c(e,t){return p[e]={key:e,module:t,importerSetters:[],linkRecord:void 0}}var p={},v="undefined"!=typeof Symbol?Symbol():"@@baseObject";o.prototype=Object.create(null),"undefined"!=typeof Symbol&&Symbol.toStringTag&&(o.prototype[Symbol.toStringTag]="Module");var m="undefined"!=typeof System&&System._nodeRequire||"undefined"!=typeof require&&void 0!==require.resolve&&"undefined"!=typeof process&&process.platform&&require,y={};return Object.freeze&&Object.freeze(y),function(e,t,n,i){return function(d){d(function(d){var s={_nodeRequire:m,register:l,registerDynamic:f,registry:{get:function(e){return p[e].module},set:c},newModule:function(e){return new o(e)}};c("@empty",new o({}));for(var a=0;a<t.length;a++)c(t[a],r(arguments[a],{}));i(s);var v=u(e[0]);if(e.length>1)for(var a=1;a<e.length;a++)u(e[a]);return n?v.__useDefault:(v instanceof o&&Object.defineProperty(v,"__esModule",{value:!0}),v)})}}}("undefined"!=typeof self?self:"undefined"!=typeof global?global:this)(["a"],["c"],!0,function($__System){this.require,this.exports,this.module;$__System.registerDynamic("b",["c"],!0,function($__require,exports,module){"use strict";this||self;Object.defineProperty(exports,"__esModule",{value:!0});var babylonjs_editor_1=$__require("c"),CodeGraph=function(){function CodeGraph(codeEditor){var _this=this;this.scriptsRoot="SCRIPTS-ROOT",this.postProcessesRoot="POST-PROCESSES-ROOT",this.codeEditor=codeEditor,this.tree=new babylonjs_editor_1.Tree("GRAPH"),this.tree.wholerow=!0,this.tree.build("GRAPH"),this.tree.onDblClick=function(id,data){data&&id!==_this.scriptsRoot&&_this.codeEditor.codeLayout.openCode(data)}}return CodeGraph.prototype.fill=function(){var _this=this,extension=this.codeEditor.editor.getExtension("BehaviorExtension"),metadatas=extension?extension.onSerialize():null;this.tree.clear(),this.tree.add({id:this.scriptsRoot,text:"Scripts",img:"icon-scene",data:this.codeEditor.scripts}),this.tree.select(this.scriptsRoot),this.codeEditor.scripts.forEach(function(script){_this.tree.add({id:script.id,text:script.name,img:"icon-behavior-editor",data:script},_this.scriptsRoot),metadatas&&metadatas.nodes.forEach(function(n){n.metadatas.find(function(m){return m.codeId===script.id})&&_this.tree.add({id:n.nodeId+(CodeGraph.Uid++).toString(),text:n.node,img:"no"},script.id)})}),this.tree.expand(this.scriptsRoot),this.tree.expand(this.postProcessesRoot)},CodeGraph.Uid=0,CodeGraph}();exports.default=CodeGraph}),$__System.registerDynamic("d",["c"],!0,function($__require,exports,module){"use strict";var __awaiter=(this||self,exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}),__generator=exports&&exports.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,"__esModule",{value:!0});var babylonjs_editor_1=$__require("c"),CodeEdit=function(){function CodeEdit(codeEditor){this.code=null,this.onClose=null,this.onChange=null,this.codeEditor=codeEditor}return CodeEdit.prototype.create=function(code){return __awaiter(this,void 0,void 0,function(){var compileTimeoutId,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return this.codeEditor.codeLayout.layout.addPanelToStack("edit-panel",{type:"component",title:code.name,componentName:code.id,html:'<div id="'+code.id+'-editor" style="width: 100%; height: 100%;"></div>',onClose:function(){_this.code.dispose(),_this.onClose&&_this.onClose()}}),this.code=new babylonjs_editor_1.CodeEditor("typescript",code.code),[4,this.code.build(code.id+"-editor")];case 1:return _a.sent(),compileTimeoutId=-1,this.code.onChange=function(value){clearTimeout(compileTimeoutId),compileTimeoutId=setTimeout(function(){var config={module:"cjs",target:"es5",experimentalDecorators:!0};code.code=value,code.compiledCode=_this.code.transpileTypeScript(code.code,code.name.replace(/ /,""),config),_this.onChange&&_this.onChange()},500)},[2]}})})},CodeEdit}();exports.default=CodeEdit}),$__System.registerDynamic("e",["c","d"],!0,function($__require,exports,module){"use strict";var __awaiter=(this||self,exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}),__generator=exports&&exports.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,"__esModule",{value:!0});var babylonjs_editor_1=$__require("c"),code_editor_1=$__require("d"),CodeLayout=function(){function CodeLayout(codeEditor){this.openedCodeEditors={},this.codeEditor=codeEditor}return CodeLayout.prototype.create=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){return this.layout=new babylonjs_editor_1.ResizableLayout("CODE-LAYOUT"),this.layout.panels=[{type:"row",content:[{type:"stack",id:"edit-panel",componentName:"Codes",isClosable:!1,height:20,content:[]}]}],this.layout.build("CODE-LAYOUT"),[2]})})},CodeLayout.prototype.openCode=function(script){return __awaiter(this,void 0,void 0,function(){var effectiveScript,codeEdit,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return(effectiveScript=this.codeEditor.scripts.find(function(c){return c.id===script.id}))?this.openedCodeEditors[script.id]?[2,this.layout.showPanelTab(script.id)]:(codeEdit=new code_editor_1.default(this.codeEditor),codeEdit.onClose=function(){return _this.closeCode(script.id)},[4,codeEdit.create(effectiveScript)]):[2];case 1:return _a.sent(),this.openedCodeEditors[script.id]={editor:codeEdit,script:script},codeEdit.onChange=function(){return _this.updateTypings()},[2]}})})},CodeLayout.prototype.closeCode=function(codeId){delete this.openedCodeEditors[codeId],this.layout.removePanel(codeId)},CodeLayout.prototype.updateTypings=function(){var extension=this.codeEditor.editor.getExtension("BehaviorExtension");if(extension){var metadatas=extension.onSerialize();for(var k in babylonjs_editor_1.CodeEditor.CustomLibs){babylonjs_editor_1.CodeEditor.CustomLibs[k].dispose()}metadatas.scripts.forEach(function(s){if(!metadatas.nodes.find(function(n){return void 0!==n.metadatas.find(function(m){return m.codeId===s.id})})){var code='declare module "'+s.name+'" {'+s.code+"}";babylonjs_editor_1.CodeEditor.CustomLibs[s.id+s.name]=window.monaco.languages.typescript.typescriptDefaults.addExtraLib(code,s.name)}})}},CodeLayout}();exports.default=CodeLayout}),$__System.registerDynamic("f",["c"],!0,function($__require,exports,module){"use strict";var __awaiter=(this||self,exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}),__generator=exports&&exports.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,"__esModule",{value:!0});var babylonjs_editor_1=$__require("c"),CodeEditorToolbar=function(){function CodeEditorToolbar(codeEditor){var _this=this;this.toolbar=null,this.codeEditor=codeEditor,this.toolbar=new babylonjs_editor_1.Toolbar("TOOLBAR"),this.toolbar.items=[{type:"menu",id:"edit",text:"Edit",img:"icon-edit",items:[{id:"set-theme-light",img:"icon-helpers",text:"Light Theme"},{id:"set-theme-dark",img:"icon-helpers",text:"Dark Theme"}]}],this.toolbar.onClick=function(target){return _this.onClick(target)},this.toolbar.build("TOOLBAR")}return CodeEditorToolbar.prototype.onClick=function(target){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(_a){switch(target){case"edit:set-theme-light":babylonjs_editor_1.ThemeSwitcher.ThemeName="Light";break;case"edit:set-theme-dark":babylonjs_editor_1.ThemeSwitcher.ThemeName="Dark"}return[2]})})},CodeEditorToolbar}();exports.default=CodeEditorToolbar}),$__System.registerDynamic("10",["c","b","e","f"],!0,function($__require,exports,module){"use strict";var __awaiter=(this||self,exports&&exports.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}),__generator=exports&&exports.__generator||function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g};Object.defineProperty(exports,"__esModule",{value:!0});var babylonjs_editor_1=$__require("c"),graph_1=$__require("b"),code_layout_1=$__require("e"),toolbar_1=$__require("f"),CodeProjectEditor=function(){function CodeProjectEditor(editor){this.scripts=[],this.layout=null,this.graph=null,this.codeLayout=null,this.editor=editor,this.scene=editor.core.scene}return CodeProjectEditor.prototype.create=function(){return __awaiter(this,void 0,void 0,function(){var theme;return __generator(this,function(_a){switch(_a.label){case 0:return this.layout=new babylonjs_editor_1.Layout("EDITOR-DIV"),this.layout.panels=[{type:"top",size:30,resizable:!1,content:'<div id="TOOLBAR" style="width: 100%; height: 100%;"></div>'},{type:"left",size:250,resizable:!0,content:'<div id="GRAPH" style="width: 100%; height: 100%;"></div>'},{type:"main",content:'<div id="CODE-LAYOUT" style="width: 100%; height: 100%; overflow: hidden;"></div>'}],this.layout.build("EDITOR-DIV"),this.graph=new graph_1.default(this),this.graph.fill(),this.codeLayout=new code_layout_1.default(this),[4,this.codeLayout.create()];case 1:return _a.sent(),this.codeLayout.updateTypings(),this.toolbar=new toolbar_1.default(this),theme=localStorage.getItem("babylonjs-editor-code-theme-name"),babylonjs_editor_1.ThemeSwitcher.ThemeName=theme||"Light",this.resize(),this._bindEvents(),[2]}})})},CodeProjectEditor.prototype.resize=function(){this.layout.element.resize(),this.codeLayout.layout.element.updateSize()},CodeProjectEditor.prototype.refresh=function(){this.graph.fill()},CodeProjectEditor.prototype._bindEvents=function(){var _this=this;window.addEventListener("resize",function(){return _this.resize()}),window.addEventListener("beforeunload",function(){localStorage.setItem("babylonjs-editor-code-theme-name",babylonjs_editor_1.ThemeSwitcher.ThemeName)}),window.addEventListener("focus",function(){var selected=_this.graph.tree.getSelected();_this.graph.fill(),selected&&_this.graph.tree.select(selected.id),_this.codeLayout.updateTypings()})},CodeProjectEditor}();exports.default=CodeProjectEditor}),$__System.registerDynamic("a",["10"],!0,function($__require,exports,module){"use strict";this||self;Object.defineProperty(exports,"__esModule",{value:!0});var project_editor_1=$__require("10");exports.default=project_editor_1.default})})(function(factory){module.exports=factory(require("babylonjs-editor"))});